# eMuse — Detailed Spec

## What this is

A web app where musicians get chord progressions based on their current mood. Desktop-primary, with mobile compatibility built in from the start. Two entry points: pick from 6 preset moods, or describe your mood in free text. Supports guitar and piano.

## Architecture

Frontend-heavy, minimal backend. A static React app with one serverless function for the free text AI path.

```
User -> [React SPA]
              |
              ├── Static mood -> reads local JSON dataset -> displays progressions
              |
              └── Free text mood -> serverless function -> LLM API -> returns progressions
```

- **Frontend**: React / TypeScript / Tailwind. Hosts the curated mood-progression dataset as bundled JSON. The entire static mood flow requires zero network calls.
- **Backend**: A single serverless function (Vercel/Netlify edge function or lightweight Node endpoint). Takes free text mood input, calls an LLM API, returns progressions.
- **Data**: Static JSON file, AI-generated at build time, human-reviewed before shipping.
- **Storage**: Browser localStorage for favorites. No database. No auth. No sessions.

The only external runtime dependency is the LLM API, and only for the free text path.

## Design Approach

**Desktop-primary, mobile-ready.** The UI is designed and optimized for desktop first — this is the primary target for design, testing, and polish. However, mobile compatibility is built into the code from the start: responsive layouts, touch-friendly tap targets, and no interactions that break on small screens. This ensures a future shift to mobile requires no rewrite. PWA support (home screen install) is parked for post-MVP.

## User Flow

### Step 1 — Landing Screen (Mood Selection)

Opens with a welcome headline and tagline — no separate welcome page:

> **eMuse**
> *Pick your mood. Get your chords. Start playing.*

Below the tagline, two paths — mood tiles above, free text input below:

- **Preset moods**: 6 mood tiles — Happy, Sad, Calm, Energetic, Melancholy, Romantic
- **Free text**: A text input where the user describes their mood in their own words
- **"Surprise me"** button: randomizes the mood selection

### Step 2 — Instrument Selection

Choose Guitar or Piano. Affects chord display in step 3 — same underlying progressions, different visual representation per instrument.

### Step 3 — Progressions & Theory

A list of chord progressions matching the selected mood, sorted by complexity (beginner-friendly first). Each progression is expandable to reveal:

- Key of the progression
- Scale it's based on
- Brief theory explanation (why this progression evokes this mood)
- "Save to favorites" button

**Chord display**: Each chord name in a progression is hoverable. On hover, a tooltip/popover shows a chord diagram (fretboard diagram for guitar, keyboard diagram for piano) — styled after tab4u.com. Diagrams are rendered as SVGs in code (not static image files) using fingering data in `src/data/chordData.ts`. Guitar diagrams show fret positions, open/muted strings, and barre chords. Piano diagrams show highlighted keys with note names. Complex chords (7ths, maj7s, 9ths) offer multiple voicings with arrow navigation. On mobile (future): tap-to-reveal instead of hover.

**Complexity filter**: Users can filter progressions by skill level (e.g., beginner / intermediate / advanced) instead of only seeing them sorted.

**Free text path**: Skips instrument selection — goes straight from Landing to Progressions. Same layout, but the LLM returns fewer results. No complexity sorting, no theory annotations, no chord diagram hover — just chord names with basic context. Kept minimal.

### Favorites

Accessible as a persistent tab or overlay — not a separate screen. Shows all saved progressions as a flat list. Each saved item displays: mood name, instrument (if applicable), chords, and key. Persisted in localStorage.

### Screen count

Three screens total: Landing (mood) → Instrument → Progressions. The free text path skips Instrument and goes Landing → Progressions directly. Favorites is an overlay, not a fourth screen. Minimal screen changes keep the experience light.

## Static Dataset Shape

```json
{
  "mood": "Melancholy",
  "progressions": [
    {
      "chords": ["Am", "F", "C", "G"],
      "complexity": 1,  // 1=beginner, 2=intermediate, 3=advanced
      "key": "Am",
      "scale": "A Natural Minor",
      "theory": "The i-VI-III-VII movement creates a sense of longing by never fully resolving."
    }
  ]
}
```

Each mood contains 15 progressions: 5 per complexity level (1=beginner, 2=intermediate, 3=advanced). 6 moods × 15 = 90 total progressions. The dataset is generated by an LLM at build time and reviewed by a musician before shipping.

## MVP Scope — What's In

- Preset mood selection (6 moods: Happy, Sad, Calm, Energetic, Melancholy, Romantic)
- Free text mood input with LLM-generated progressions
- Guitar and piano support
- Progressions sorted by complexity (static path)
- Scale and theory context per progression (static path)
- "Surprise me" random mood
- Favorites via localStorage
- Desktop-primary UI — designed and polished for desktop screens
- Mobile-ready code from day one — responsive layouts, touch-friendly tap targets, no interactions that break on small screens
- Display the key of each progression
- Complexity filter (narrow results by skill level)
- Chord hover preview — hovering a chord name shows its diagram (fretboard for guitar, keyboard for piano) as a tooltip

## Parking Lot — What's Out (for now)

- ~~Audio preview / playback of progressions~~ — **Done.** Web Audio API synth plays chords in sequence with active chord highlighting.
- User accounts and server-side persistence
- Instruments beyond guitar and piano
- Social features (sharing, community)
- Complexity sorting and theory annotations for the free text AI path
- More granular / nuanced mood options
- PWA (service worker + web manifest for home screen install)
- ~~Mood color atmosphere~~ — **Done.** Theme toggle with Mood mode shifts background gradient per mood.
- ~~"Songs like this"~~ — **Done.** Roman numeral analysis matches progression patterns to 50+ famous songs.
- Chord diagram tap-to-reveal for mobile (replace hover with tap)

## Technology

| Layer | Choice |
|-------|--------|
| Frontend | React, TypeScript, Tailwind CSS |
| Backend | Single serverless function (Node) |
| LLM | OpenAI API (or equivalent) for free text path |
| Data | Static JSON bundled with frontend |
| Storage | Browser localStorage |
| Hosting | Vercel or Netlify (static + serverless in one) |

## Security Considerations

- The LLM API key lives server-side in the serverless function — never exposed to the client
- Rate-limit the free text endpoint to prevent abuse and runaway API costs
- Sanitize free text input before passing to the LLM
- No user data leaves the browser (localStorage only)
